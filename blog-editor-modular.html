<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://use.typekit.net; connect-src 'self' https://api.github.com https://raw.githubusercontent.com https://api.groq.com https://www.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' https: data: blob:; media-src 'self' https: blob:; font-src 'self' https://fonts.gstatic.com https://use.typekit.net; worker-src 'self' blob:;">
    <title>Blog Editor - GlÃ¼ck Ã¼ber Zweifel</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">

    <!-- Modular CSS -->
    <link rel="stylesheet" href="css/blog-editor-base.css">
    <link rel="stylesheet" href="css/blog-editor-panels.css">
    <link rel="stylesheet" href="css/blog-editor-ai.css">
    <link rel="stylesheet" href="css/blog-editor-video.css">
    <link rel="stylesheet" href="css/blog-editor-blocks.css">
</head>
<body>

<!-- Setup Screen -->
<div class="setup-screen" id="setupScreen">
    <div class="setup-card">
        <div style="font-size: 3rem;">âœ</div>
        <h1>Blog Editor</h1>
        <p>Schreibe und verÃ¶ffentliche Blog-Posts direkt auf deiner Website.</p>
        <input class="setup-input" id="tokenInput" placeholder="GitHub Token eingeben..." type="password">
        <button class="setup-btn" id="setupBtn" onclick="setupToken()">Editor starten</button>
        <a class="setup-link" href="cms/">ZurÃ¼ck zum Website-Editor</a>
    </div>
</div>

<!-- Skip Link fÃ¼r Accessibility -->
<a href="#main-editor" class="skip-link">Zum Editor springen</a>

<!-- Header -->
<header class="header" role="banner">
    <div class="header-left">
        <button class="mobile-menu-toggle" onclick="toggleMobileSidebar()" aria-label="Seitenleiste Ã¶ffnen" aria-expanded="false" aria-controls="sidebar">â˜°</button>
        <div class="logo" aria-label="Blog Editor">
            <div class="logo-icon" aria-hidden="true">âœ</div>
            Editor
        </div>
        <nav class="mode-switch" role="navigation" aria-label="Editor-Modus">
            <a href="cms/" class="mode-btn" title="Website-Seiten bearbeiten">Seiten</a>
            <a href="blog-editor-modular.html" class="mode-btn active" aria-current="page" title="Blog-Artikel schreiben">Blog</a>
        </nav>
    </div>
    <div class="header-center">
        <div class="autosave-indicator" role="status" aria-live="polite">
            <div class="autosave-dot" aria-hidden="true"></div>
            <span id="autosaveText">Autosave aktiv</span>
        </div>
        <div class="status-indicator" role="status" aria-live="polite">
            <div class="status-dot" id="statusDot" aria-hidden="true"></div>
            <span id="statusText">Bereit</span>
        </div>
    </div>
    <div class="header-right">
        <button class="btn btn-ghost shortcuts-help-btn" onclick="openShortcutsModal()" title="Tastenkombinationen (?)" aria-label="Tastenkombinationen anzeigen">âŒ¨ï¸</button>
        <button class="ai-header-btn" onclick="toggleAIPanel()" aria-label="KI-Assistent Ã¶ffnen" aria-expanded="false" aria-controls="aiPanel">âœ¨ KI-Assistent</button>
        <button class="btn btn-ghost" onclick="openPreview()" aria-label="Vorschau anzeigen">Vorschau</button>
        <button class="btn btn-ghost" onclick="openExportModal()" title="Exportieren" aria-label="Beitrag exportieren">ğŸ“¤ Export</button>
        <button class="btn btn-ghost" onclick="toggleQueue()" aria-label="Warteschlange anzeigen" aria-expanded="false" aria-controls="queuePanel">Warteschlange</button>
        <button class="btn btn-ghost" onclick="saveDraft()" aria-label="Entwurf speichern">Entwurf speichern</button>
        <button class="btn btn-success" onclick="publishPost()" aria-label="Beitrag verÃ¶ffentlichen">VerÃ¶ffentlichen</button>
    </div>
</header>

<!-- Main Container -->
<main class="main-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar" role="complementary" aria-label="Beitragsliste">
        <div class="sidebar-header">
            <h2>BeitrÃ¤ge</h2>
        </div>
        <div class="sidebar-tabs" role="tablist" aria-label="BeitrÃ¤ge filtern">
            <button class="sidebar-tab active" onclick="showTab('drafts')" role="tab" aria-selected="true" aria-controls="postList">EntwÃ¼rfe</button>
            <button class="sidebar-tab" onclick="showTab('published')" role="tab" aria-selected="false" aria-controls="postList">VerÃ¶ffentlicht</button>
            <button class="sidebar-tab" onclick="showTab('scheduled')" role="tab" aria-selected="false" aria-controls="postList">Geplant</button>
        </div>
        <div class="sidebar-search">
            <label for="postSearch" class="sr-only">BeitrÃ¤ge suchen</label>
            <input type="search" id="postSearch" placeholder="BeitrÃ¤ge suchen..." oninput="filterPosts(this.value)" aria-label="BeitrÃ¤ge durchsuchen">
            <span class="search-icon" aria-hidden="true">ğŸ”</span>
        </div>
        <button class="new-post-btn" onclick="createNewPost()" aria-label="Neuen Beitrag erstellen">
            <span aria-hidden="true">+</span> Neuer Beitrag
        </button>
        <div class="sidebar-content" id="postList" role="tabpanel" aria-label="Beitragsliste"></div>
    </aside>

    <!-- Mobile Sidebar Backdrop -->
    <div class="sidebar-backdrop" onclick="closeMobileSidebar()" aria-hidden="true"></div>

    <!-- Editor -->
    <div class="editor-container" id="main-editor" role="main">
        <!-- Toolbar -->
        <div class="editor-toolbar" role="toolbar" aria-label="Text-Formatierung">
            <div class="toolbar-group" role="group" aria-label="Blocktyp">
                <label for="blockType" class="sr-only">Blocktyp wÃ¤hlen</label>
                <select class="toolbar-select" id="blockType" onchange="formatBlock(this.value)" aria-label="Blocktyp">
                    <option value="p">Absatz</option>
                    <option value="h2">Ãœberschrift 2</option>
                    <option value="h3">Ãœberschrift 3</option>
                    <option value="h4">Ãœberschrift 4</option>
                    <option value="blockquote">Zitat</option>
                </select>
            </div>
            <div class="toolbar-group" role="group" aria-label="Textformatierung">
                <button class="toolbar-btn" onclick="execCmd('bold')" title="Fett (Cmd+B)" aria-label="Fett"><strong>B</strong></button>
                <button class="toolbar-btn" onclick="execCmd('italic')" title="Kursiv (Cmd+I)" aria-label="Kursiv"><em>I</em></button>
                <button class="toolbar-btn" onclick="execCmd('underline')" title="Unterstrichen" aria-label="Unterstrichen"><u>U</u></button>
                <button class="toolbar-btn" onclick="execCmd('strikeThrough')" title="Durchgestrichen" aria-label="Durchgestrichen"><s>S</s></button>
            </div>
            <div class="toolbar-group" role="group" aria-label="Listen">
                <button class="toolbar-btn" onclick="execCmd('insertUnorderedList')" title="AufzÃ¤hlung" aria-label="AufzÃ¤hlung einfÃ¼gen">â€¢</button>
                <button class="toolbar-btn" onclick="execCmd('insertOrderedList')" title="Nummerierung" aria-label="Nummerierte Liste">1.</button>
            </div>
            <div class="toolbar-group" role="group" aria-label="Medien einfÃ¼gen">
                <button class="toolbar-btn" onclick="insertLink()" title="Link einfÃ¼gen" aria-label="Link einfÃ¼gen">ğŸ”—</button>
                <button class="toolbar-btn" onclick="openImageModal()" title="Bild einfÃ¼gen" aria-label="Bild einfÃ¼gen">ğŸ“·</button>
                <button class="toolbar-btn" onclick="insertVideo()" title="Video einfÃ¼gen" aria-label="Video einfÃ¼gen">ğŸ¥</button>
                <button class="toolbar-btn" onclick="openVideoRecordModal()" title="Video aufnehmen" aria-label="Video aufnehmen">ğŸ“¹</button>
            </div>
            <div class="toolbar-group" role="group" aria-label="Ausrichtung">
                <button class="toolbar-btn" onclick="execCmd('justifyLeft')" title="Links" aria-label="LinksbÃ¼ndig">â‡¤</button>
                <button class="toolbar-btn" onclick="execCmd('justifyCenter')" title="Zentriert" aria-label="Zentriert">â†”</button>
                <button class="toolbar-btn" onclick="execCmd('justifyRight')" title="Rechts" aria-label="RechtsbÃ¼ndig">â‡¥</button>
            </div>
            <div class="toolbar-group" role="group" aria-label="Verlauf">
                <button class="toolbar-btn" id="undoBlockBtn" onclick="undo()" title="Block-Ã„nderung rÃ¼ckgÃ¤ngig (Cmd+Z)" aria-label="RÃ¼ckgÃ¤ngig">â†¶</button>
                <button class="toolbar-btn" id="redoBlockBtn" onclick="redo()" title="Block-Ã„nderung wiederholen (Cmd+Y)" aria-label="Wiederholen">â†·</button>
            </div>
            <div class="toolbar-group" role="group" aria-label="Ansicht">
                <button class="toolbar-btn" onclick="toggleFullscreen()" title="Vollbild" aria-label="Vollbildmodus umschalten">â›¶</button>
            </div>
            <div class="toolbar-group" role="group" aria-label="KI-Funktionen">
                <button class="toolbar-btn ai" onclick="aiImproveText()" title="Text mit KI verbessern" aria-label="Text mit KI verbessern">âœ¨</button>
                <button class="toolbar-btn" onclick="toggleVoiceInput()" title="Spracheingabe" id="voiceToolbarBtn" aria-label="Spracheingabe aktivieren">ğŸ¤</button>
            </div>
        </div>

        <!-- Editor Content -->
        <div class="editor-main">
            <div class="editor-content">
                <label for="postTitle" class="sr-only">Beitragstitel</label>
                <input class="title-input" id="postTitle" oninput="onContentChange()" placeholder="Titel eingeben..." type="text" aria-required="true">
                <label for="postExcerpt" class="sr-only">Kurzbeschreibung</label>
                <textarea class="excerpt-input" id="postExcerpt" oninput="onContentChange()" placeholder="Kurzbeschreibung fÃ¼r SEO und Vorschau..." rows="2" aria-describedby="excerptHelp"></textarea>
                <span id="excerptHelp" class="sr-only">Kurzbeschreibung fÃ¼r Suchmaschinen und Social Media</span>

                <!-- Block-basierter Editor -->
                <div id="blocksContainer" role="list" aria-label="InhaltsblÃ¶cke">
                    <!-- BlÃ¶cke werden hier dynamisch eingefÃ¼gt -->
                </div>

                <!-- Add Block Button -->
                <button class="add-block-btn" onclick="showBlockMenu()" aria-label="Neuen Block hinzufÃ¼gen" aria-haspopup="menu">
                    + Block hinzufÃ¼gen
                </button>

                <!-- Hidden: Original content editor fÃ¼r KompatibilitÃ¤t -->
                <div class="content-editor" contenteditable="true" id="postContent" oninput="onContentChange()" style="display: none;">
                    <p>Beginne hier mit deinem Beitrag...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <aside class="settings-panel">
        <div class="settings-section">
            <h3>ğŸ“· Beitragsbild</h3>
            <div class="featured-image-upload" id="featuredImageUpload" onclick="uploadFeaturedImage()">
                <div class="upload-text">
                    <div class="upload-icon">ğŸ“·</div>
                    <div>Bild hochladen oder ziehen</div>
                </div>
            </div>
            <div class="settings-row">
                <label class="settings-label">Alt-Text (SEO)</label>
                <input class="settings-input" id="featuredImageAlt" placeholder="Bildbeschreibung fÃ¼r SEO..." type="text">
            </div>
        </div>

        <div class="settings-section">
            <h3>ğŸ“ Kategorien</h3>
            <div class="category-tags" id="categoryTags">
                <span class="category-tag" data-cat="achtsamkeit">Achtsamkeit</span>
                <span class="category-tag" data-cat="selbstliebe">Selbstliebe</span>
                <span class="category-tag" data-cat="beziehung">Beziehung</span>
                <span class="category-tag" data-cat="heldinnenreise">Heldinnenreise</span>
                <span class="category-tag" data-cat="hochbegabung">Hochbegabung</span>
                <span class="category-tag" data-cat="koerper">KÃ¶rper & Nervensystem</span>
            </div>
        </div>

        <div class="settings-section">
            <h3>ğŸ”– SEO</h3>
            <div class="settings-row">
                <label class="settings-label">Meta-Titel</label>
                <input class="settings-input" id="metaTitle" placeholder="SEO Titel (max 60 Zeichen)" type="text">
                <small><span id="metaTitleCount">0</span>/60 Zeichen</small>
            </div>
            <div class="settings-row">
                <label class="settings-label">Meta-Beschreibung</label>
                <textarea class="settings-textarea" id="metaDescription" placeholder="SEO Beschreibung (max 160 Zeichen)"></textarea>
                <small><span id="metaDescCount">0</span>/160 Zeichen</small>
            </div>
            <div class="settings-row">
                <label class="settings-label">URL-Slug</label>
                <input class="settings-input" id="urlSlug" placeholder="url-freundlicher-name" type="text">
            </div>
        </div>

        <div class="settings-section">
            <h3>ğŸ“… VerÃ¶ffentlichung</h3>
            <div class="settings-row">
                <label class="settings-label">Zeitplan</label>
                <div class="schedule-picker">
                    <input id="scheduleDate" type="date">
                    <input id="scheduleTime" type="time" value="09:00">
                </div>
            </div>
            <button class="btn btn-primary" onclick="schedulePost()">Planen</button>
        </div>

        <div class="settings-section">
            <h3>âš™ Autor</h3>
            <div class="settings-row">
                <label class="settings-label">Autor</label>
                <input class="settings-input" id="authorName" type="text" value="Kathrin Stahl">
            </div>
        </div>

        <div class="settings-section">
            <h3>ğŸ“œ Verlauf</h3>
            <button class="btn btn-ghost" onclick="openVersionsModal()" style="width: 100%;">
                Versionsverlauf anzeigen
            </button>
            <small style="display: block; margin-top: 0.5rem; color: var(--text-light);">
                Bis zu 20 Versionen pro Beitrag
            </small>
        </div>
    </aside>
</main>

<!-- Publishing Queue Panel -->
<div class="queue-panel" id="queuePanel">
    <div class="queue-header">
        <h3>VerÃ¶ffentlichungs-Warteschlange</h3>
        <button class="btn btn-ghost" onclick="toggleQueue()">Ã—</button>
    </div>
    <div class="queue-content" id="queueContent"></div>
</div>

<!-- Preview Modal -->
<div class="preview-modal" id="previewModal">
    <div class="preview-container">
        <div class="preview-header">
            <h3>Vorschau</h3>
            <div class="preview-device-toggle">
                <button class="preview-device-btn active" onclick="setPreviewDevice('desktop')">Desktop</button>
                <button class="preview-device-btn" onclick="setPreviewDevice('tablet')">Tablet</button>
                <button class="preview-device-btn" onclick="setPreviewDevice('mobile')">Mobil</button>
            </div>
            <button class="btn btn-ghost" onclick="closePreview()">Ã— SchlieÃŸen</button>
        </div>
        <div class="preview-content">
            <div class="preview-frame desktop" id="previewFrame"></div>
        </div>
    </div>
</div>

<!-- Image Upload Modal -->
<div class="image-modal" id="imageModal">
    <div class="image-modal-content">
        <div class="image-modal-header">
            <h3>Bild einfÃ¼gen</h3>
            <button class="btn btn-ghost" onclick="closeImageModal()">Ã—</button>
        </div>
        <div class="image-modal-body">
            <div class="image-drop-zone" id="imageDropZone" onclick="uploadNewImage()">
                <div style="font-size: 2rem;">ğŸ“·</div>
                <div>Neues Bild hochladen</div>
                <small style="color: var(--text-light);">Automatische Komprimierung fÃ¼r schnellere Ladezeiten</small>
            </div>
            <h4>Oder aus Mediathek wÃ¤hlen:</h4>
            <div class="image-gallery" id="imageGallery"></div>
            <div class="settings-row">
                <label class="settings-label">Alt-Text</label>
                <input class="settings-input" id="imageAltText" placeholder="Bildbeschreibung..." type="text">
            </div>
            <button class="btn btn-primary" onclick="insertSelectedImage()">Bild einfÃ¼gen</button>
        </div>
    </div>
</div>

<!-- Editor Stats -->
<div class="editor-stats">
    <div class="stat-item">
        <span>ğŸ“</span>
        <span id="wordCount">0</span> WÃ¶rter
    </div>
    <div class="stat-item">
        <span>ğŸ•‘</span>
        <span id="readingTime">0</span> Min. Lesezeit
    </div>
    <div class="stat-item">
        <span>ğŸ“„</span>
        <span id="charCount">0</span> Zeichen
    </div>
</div>

<!-- Block Menu -->
<div id="blockMenu">
    <div class="block-menu-grid">
        <button class="block-menu-item" onclick="addBlockFromMenu('text')">
            <span>ğŸ“</span>
            <span>Text</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('heading')">
            <span>ğŸ”¤</span>
            <span>Ãœberschrift</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('image')">
            <span>ğŸ“·</span>
            <span>Bild</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('video')">
            <span>ğŸ¬</span>
            <span>Video</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('recording')">
            <span>ğŸ“¹</span>
            <span>Aufnahme</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('code')">
            <span>&lt;/&gt;</span>
            <span>Code</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('quote')">
            <span>â</span>
            <span>Zitat</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('callout')">
            <span>ğŸ’¡</span>
            <span>Highlight</span>
        </button>
        <button class="block-menu-item" onclick="addBlockFromMenu('divider')">
            <span>â€•</span>
            <span>Trennlinie</span>
        </button>
        <button class="block-menu-item" onclick="hideBlockMenu()" style="background: #fee;">
            <span>âœ•</span>
            <span>SchlieÃŸen</span>
        </button>
    </div>
</div>
<div class="block-menu-backdrop" onclick="hideBlockMenu()" style="display: none;"></div>

<!-- Block Settings Modal -->
<div class="modal" id="blockSettingsModal">
    <div class="modal-backdrop" onclick="closeBlockSettings()"></div>
    <div class="modal-content" style="max-width: 400px;">
        <div class="modal-header">
            <h3>âš™ï¸ Block-Einstellungen</h3>
            <button onclick="closeBlockSettings()" class="modal-close">Ã—</button>
        </div>
        <div class="modal-body">
            <!-- Ausrichtung -->
            <div class="settings-row">
                <label class="settings-label">Ausrichtung</label>
                <div class="block-settings-row">
                    <button class="setting-option" data-setting="align" data-value="left" onclick="setBlockSetting('align', 'left')">â‡¤ Links</button>
                    <button class="setting-option" data-setting="align" data-value="center" onclick="setBlockSetting('align', 'center')">â†” Mitte</button>
                    <button class="setting-option" data-setting="align" data-value="right" onclick="setBlockSetting('align', 'right')">â‡¥ Rechts</button>
                </div>
            </div>

            <!-- Breite -->
            <div class="settings-row">
                <label class="settings-label">Breite</label>
                <div class="block-settings-row">
                    <button class="setting-option" data-setting="width" data-value="full" onclick="setBlockSetting('width', 'full')">100%</button>
                    <button class="setting-option" data-setting="width" data-value="wide" onclick="setBlockSetting('width', 'wide')">75%</button>
                    <button class="setting-option" data-setting="width" data-value="medium" onclick="setBlockSetting('width', 'medium')">50%</button>
                </div>
            </div>

            <!-- Abstand -->
            <div class="settings-row">
                <label class="settings-label">Abstand oben/unten</label>
                <div class="block-settings-row">
                    <button class="setting-option" data-setting="spacing" data-value="none" onclick="setBlockSetting('spacing', 'none')">Keiner</button>
                    <button class="setting-option" data-setting="spacing" data-value="small" onclick="setBlockSetting('spacing', 'small')">Klein</button>
                    <button class="setting-option" data-setting="spacing" data-value="large" onclick="setBlockSetting('spacing', 'large')">GroÃŸ</button>
                </div>
            </div>

            <!-- Hintergrund (fÃ¼r Callouts/Quotes) -->
            <div class="settings-row" id="bgColorRow" style="display: none;">
                <label class="settings-label">Hintergrundfarbe</label>
                <div class="block-settings-row color-options">
                    <button class="color-option" style="background: transparent; border: 2px dashed #ccc;" onclick="setBlockSetting('bgColor', 'none')" title="Keine"></button>
                    <button class="color-option" style="background: #f8f9fa;" onclick="setBlockSetting('bgColor', '#f8f9fa')" title="Grau"></button>
                    <button class="color-option" style="background: #fff3e0;" onclick="setBlockSetting('bgColor', '#fff3e0')" title="Warm"></button>
                    <button class="color-option" style="background: #e8f5e9;" onclick="setBlockSetting('bgColor', '#e8f5e9')" title="GrÃ¼n"></button>
                    <button class="color-option" style="background: #e3f2fd;" onclick="setBlockSetting('bgColor', '#e3f2fd')" title="Blau"></button>
                    <button class="color-option" style="background: #fce4ec;" onclick="setBlockSetting('bgColor', '#fce4ec')" title="Rosa"></button>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="closeBlockSettings()">SchlieÃŸen</button>
        </div>
    </div>
</div>

<!-- Versions Modal -->
<div class="modal" id="versionsModal">
    <div class="modal-backdrop" onclick="closeVersionsModal()"></div>
    <div class="modal-content versions-modal-content">
        <div class="modal-header">
            <h3>ğŸ“œ Versionsverlauf</h3>
            <button onclick="closeVersionsModal()" class="modal-close">Ã—</button>
        </div>
        <div class="modal-body" id="versionsList">
            <!-- Versionen werden dynamisch geladen -->
        </div>
    </div>
</div>

<!-- Template Selection Modal -->
<div class="modal" id="templateModal">
    <div class="modal-backdrop" onclick="closeTemplateModal()"></div>
    <div class="modal-content template-modal-content">
        <div class="modal-header">
            <h3>ğŸ“ Vorlage wÃ¤hlen</h3>
            <button onclick="closeTemplateModal()" class="modal-close">Ã—</button>
        </div>
        <div class="modal-body template-grid" id="templateGrid">
            <!-- Templates werden dynamisch geladen -->
        </div>
    </div>
</div>

<!-- Export Modal -->
<div class="modal" id="exportModal">
    <div class="modal-backdrop" onclick="closeExportModal()"></div>
    <div class="modal-content export-modal-content">
        <div class="modal-header">
            <h3>ğŸ“¤ Beitrag exportieren</h3>
            <button onclick="closeExportModal()" class="modal-close">Ã—</button>
        </div>
        <div class="modal-body">
            <p class="export-info">
                Exportiere <strong class="export-preview-title">Deinen Beitrag</strong> in verschiedene Formate:
            </p>
            <div class="export-options">
                <div class="export-option" onclick="exportAsMarkdown()">
                    <div class="export-option-icon">ğŸ“</div>
                    <div class="export-option-content">
                        <div class="export-option-title">Markdown (.md)</div>
                        <div class="export-option-desc">Ideal fÃ¼r statische Site-Generatoren, GitHub, Notion</div>
                    </div>
                </div>
                <div class="export-option" onclick="exportAsPDF()">
                    <div class="export-option-icon">ğŸ“„</div>
                    <div class="export-option-content">
                        <div class="export-option-title">PDF (Druckansicht)</div>
                        <div class="export-option-desc">Professionell formatiert, druckbereit</div>
                    </div>
                </div>
                <div class="export-option" onclick="exportAsHTML()">
                    <div class="export-option-icon">ğŸŒ</div>
                    <div class="export-option-content">
                        <div class="export-option-title">HTML (.html)</div>
                        <div class="export-option-desc">VollstÃ¤ndige Blog-Seite als Backup</div>
                    </div>
                </div>
                <div class="export-option" onclick="copyAsMarkdown()">
                    <div class="export-option-icon">ğŸ“‹</div>
                    <div class="export-option-content">
                        <div class="export-option-title">In Zwischenablage kopieren</div>
                        <div class="export-option-desc">Markdown direkt kopieren, zum EinfÃ¼gen</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Keyboard Shortcuts Modal -->
<div class="modal" id="shortcutsModal">
    <div class="modal-backdrop" onclick="closeShortcutsModal()"></div>
    <div class="modal-content shortcuts-modal-content">
        <div class="modal-header">
            <h3>âŒ¨ï¸ Tastenkombinationen</h3>
            <button onclick="closeShortcutsModal()" class="modal-close">Ã—</button>
        </div>
        <div class="modal-body shortcuts-grid">
            <!-- Allgemein -->
            <div class="shortcuts-section">
                <h4>Allgemein</h4>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>S</kbd></span>
                    <span class="shortcut-desc">Entwurf speichern</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>Z</kbd></span>
                    <span class="shortcut-desc">RÃ¼ckgÃ¤ngig</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>Y</kbd></span>
                    <span class="shortcut-desc">Wiederherstellen</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>Esc</kbd></span>
                    <span class="shortcut-desc">Modal/Panel schlieÃŸen</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>?</kbd></span>
                    <span class="shortcut-desc">Diese Hilfe anzeigen</span>
                </div>
            </div>

            <!-- Formatierung -->
            <div class="shortcuts-section">
                <h4>Textformatierung</h4>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>B</kbd></span>
                    <span class="shortcut-desc">Fett</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>I</kbd></span>
                    <span class="shortcut-desc">Kursiv</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>U</kbd></span>
                    <span class="shortcut-desc">Unterstrichen</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>K</kbd></span>
                    <span class="shortcut-desc">Link einfÃ¼gen</span>
                </div>
            </div>

            <!-- BlÃ¶cke -->
            <div class="shortcuts-section">
                <h4>Block-Editor</h4>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>/</kbd></span>
                    <span class="shortcut-desc">Block-MenÃ¼ Ã¶ffnen</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>â†‘</kbd><kbd>â†“</kbd></span>
                    <span class="shortcut-desc">Zwischen BlÃ¶cken navigieren</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>Del</kbd></span>
                    <span class="shortcut-desc">Block lÃ¶schen (wenn leer)</span>
                </div>
            </div>

            <!-- Navigation -->
            <div class="shortcuts-section">
                <h4>Navigation</h4>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>P</kbd></span>
                    <span class="shortcut-desc">Vorschau Ã¶ffnen</span>
                </div>
                <div class="shortcut-row">
                    <span class="shortcut-keys"><kbd>âŒ˜</kbd><kbd>.</kbd></span>
                    <span class="shortcut-desc">KI-Panel Ã¶ffnen/schlieÃŸen</span>
                </div>
            </div>
        </div>
        <div class="modal-footer" style="font-size: 0.8rem; color: var(--text-light);">
            <span id="shortcutModifier">âŒ˜ = Cmd (Mac) / Ctrl (Windows)</span>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- AI Assistant Panel -->
<div class="ai-panel" id="aiPanel">
    <div class="ai-panel-header">
        <h3>âœ¨ KI-Assistent</h3>
        <button class="btn btn-ghost" onclick="toggleAIPanel()" style="padding: 0.25rem 0.5rem;">Ã—</button>
    </div>
    <div class="ai-panel-content">
        <!-- Voice Input -->
        <div class="ai-section">
            <h4>ğŸ¤ Spracheingabe</h4>
            <button class="voice-btn" id="voiceBtn" onclick="toggleVoiceInput()">ğŸ¤</button>
            <div class="voice-status" id="voiceStatus">Klicke zum Sprechen</div>
            <div class="voice-transcript" id="voiceTranscript" style="display: none;"></div>
            <button class="ai-btn" id="insertVoiceBtn" onclick="insertVoiceText()" style="display: none; margin-top: 0.5rem;">â†“ Text einfÃ¼gen</button>
        </div>

        <!-- Writing Assistance -->
        <div class="ai-section">
            <h4>âœï¸ Schreibhilfe</h4>
            <button class="ai-btn" onclick="aiImproveGrammar()" id="btnGrammar">ğŸ“ Grammatik & Stil verbessern</button>
            <button class="ai-btn" onclick="aiChangeTone('warmherzig')" id="btnTone">ğŸ’ Warmherziger Ton</button>
            <button class="ai-btn" onclick="aiShortenText()" id="btnShorten">âœ‚ï¸ Text kÃ¼rzen</button>
            <button class="ai-btn" onclick="aiExpandText()" id="btnExpand">ğŸ“– Text erweitern</button>
            <div class="ai-result" id="aiWritingResult" style="display: none;"></div>
            <button class="ai-btn ai-btn-primary" id="applyAIBtn" onclick="applyAISuggestion()" style="display: none;">âœ“ Ã„nderung Ã¼bernehmen</button>
        </div>

        <!-- Auto-Categorization -->
        <div class="ai-section">
            <h4>ğŸ·ï¸ Automatische Kategorisierung</h4>
            <button class="ai-btn ai-btn-primary" onclick="aiCategorize()" id="btnCategorize">ğŸ”® Kategorien vorschlagen</button>
            <div class="ai-categories" id="aiCategories"></div>
        </div>

        <!-- Content Generation -->
        <div class="ai-section">
            <h4>ğŸ“ Inhalt generieren</h4>
            <button class="ai-btn" onclick="aiGenerateSummary()" id="btnSummary">ğŸ“‹ Zusammenfassung erstellen</button>
            <button class="ai-btn" onclick="aiGenerateTitle()" id="btnTitle">ğŸ’¡ Titel vorschlagen</button>
            <button class="ai-btn" onclick="aiGenerateMetaDescription()" id="btnMeta">ğŸ” Meta-Beschreibung (SEO)</button>
            <button class="ai-btn" onclick="aiGenerateOutline()" id="btnOutline">ğŸ“‘ Gliederung erstellen</button>
            <div class="ai-result" id="aiContentResult" style="display: none;"></div>
        </div>

        <!-- YouTube Topic Ideas -->
        <div class="ai-section">
            <h4>ğŸ¬ ThemenvorschlÃ¤ge aus Videos</h4>
            <p style="font-size: 0.85rem; color: var(--text-light); margin-bottom: 0.75rem;">Basierend auf Kathrins neuesten YouTube-Videos</p>
            <button class="ai-btn" onclick="loadYouTubeIdeas()" id="btnYouTube">ğŸ”„ Ideen laden</button>
            <div id="youtubeIdeas"></div>
        </div>

        <!-- Smart Formatting -->
        <div class="ai-section">
            <h4>ğŸ¨ Smart-Formatierung</h4>
            <button class="ai-btn" onclick="insertHighlightBox()" id="btnHighlight">ğŸ’¡ Highlight-Box einfÃ¼gen</button>
            <button class="ai-btn" onclick="insertCallout()" id="btnCallout">ğŸ“Œ Callout einfÃ¼gen</button>
            <button class="ai-btn" onclick="insertBlockquote()" id="btnQuote">â Inspirierendes Zitat</button>
            <button class="ai-btn" onclick="aiFormatForReadability()" id="btnReadability">ğŸ“– Lesbarkeit verbessern</button>
        </div>
    </div>
</div>

<!-- AI Setup Modal -->
<div class="ai-setup-modal" id="aiSetupModal">
    <div class="ai-setup-card">
        <h2>âœ¨ KI-Assistent einrichten</h2>
        <p>
            Um den KI-Assistenten zu nutzen, benÃ¶tigst du einen kostenlosen Groq API-Key.<br><br>
            <a href="https://console.groq.com/keys" target="_blank">â†’ Groq API Key erstellen (kostenlos)</a>
        </p>
        <input class="setup-input" id="groqKeyInput" placeholder="gsk_xxxxxxxxxxxxx" type="password">
        <button class="setup-btn" onclick="saveGroqKey()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">KI aktivieren</button>
        <button class="btn btn-ghost" onclick="closeAISetup()" style="width: 100%; margin-top: 0.5rem; color: var(--text-light);">SpÃ¤ter einrichten</button>
    </div>
</div>

<!-- Video Recording Modal -->
<div class="video-record-modal" id="videoRecordModal">
    <div class="video-record-container">
        <div class="video-record-header">
            <h3>ğŸ¬ Video aufnehmen</h3>
            <span id="videoRecordStatus">Bereit</span>
            <button class="btn btn-ghost" onclick="closeVideoRecordModal()">Ã—</button>
        </div>

        <!-- Recording View -->
        <div class="video-record-body" id="recordingView">
            <div class="video-preview-container">
                <video id="videoRecordPreview" autoplay muted playsinline></video>
                <div class="vad-indicator" id="vadIndicator">ğŸ”‡ Stille</div>
            </div>

            <div class="video-record-controls">
                <div class="record-timer" id="recordTimer">0:00</div>
                <button class="record-btn" id="recordVideoBtn" onclick="videoState.isRecording ? stopVideoRecording() : startVideoRecording()">
                    âº Aufnahme starten
                </button>
            </div>

            <div class="video-tips">
                <p>ğŸ’¡ <strong>Tipps:</strong> Sprich klar und deutlich. Stille-Pausen werden automatisch erkannt und kÃ¶nnen spÃ¤ter entfernt werden.</p>
            </div>
        </div>

        <!-- Edit View (nach Aufnahme) -->
        <div class="video-record-body hidden" id="editView">
            <div class="video-edit-preview">
                <video id="videoEditPreview" controls></video>
            </div>

            <div class="waveform-section">
                <h4>Audio-Analyse</h4>
                <div class="waveform-wrapper">
                    <div id="waveformContainer"></div>
                    <div id="silenceMarkers" class="silence-markers-overlay"></div>
                </div>
                <div class="silence-legend">
                    <span class="legend-item"><span class="legend-color silence"></span> Stille (wird entfernt)</span>
                    <span class="legend-item"><span class="legend-color excluded"></span> Behalten (klicke zum Ã„ndern)</span>
                </div>
                <p id="silenceStats">0 Stille-Regionen erkannt</p>
            </div>

            <div class="video-edit-controls">
                <button class="btn btn-ghost" onclick="previewWithoutSilence()">â–¶ Vorschau ohne Stille</button>
                <button class="btn btn-ghost" onclick="resetVideoState()">â†º Neu aufnehmen</button>
                <button class="btn btn-primary" onclick="exportVideo(true)">âœ“ Video einfÃ¼gen (ohne Stille)</button>
                <button class="btn btn-ghost" onclick="exportVideo(false)">Video einfÃ¼gen (Original)</button>
            </div>
        </div>
    </div>
</div>

<!-- DOMPurify fÃ¼r sichere HTML-Sanitization -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js" crossorigin="anonymous"></script>

<!-- Wavesurfer.js fÃ¼r Audio-Waveform -->
<script src="https://cdn.jsdelivr.net/npm/wavesurfer.js@7/dist/wavesurfer.min.js"></script>

<!-- VAD (Voice Activity Detection) fÃ¼r Stille-Erkennung -->
<script src="https://cdn.jsdelivr.net/npm/@ricky0123/vad-web@0.0.19/dist/bundle.min.js"></script>

<!-- Modular JavaScript (Reihenfolge wichtig!) -->
<script src="js/blog-editor-config.js"></script>
<script src="js/blog-editor-utils.js"></script>
<script src="js/blog-editor-github.js"></script>
<script src="js/blog-editor-core.js"></script>
<script src="js/blog-editor-ai.js"></script>
<script src="js/blog-editor-video.js"></script>
<script src="js/blog-editor-blocks.js"></script>

<!-- Init -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        checkSetup();
        initAI();
        initBlockEditor();
    });
</script>

</body>
</html>
